<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êô®ÊòèÊïÖ‰∫∫ÁöÑAIÂ∑•ÂÖ∑Êòü‰∫ë - Ê≤âÊµ∏ÂºèÊé¢Á¥¢</title>
    <meta name="description" content="Êé¢Á¥¢Êô®ÊòèÊïÖ‰∫∫ÁöÑAIÂ∑•ÂÖ∑‰∫§‰∫íÂºè3DÊòü‰∫ëÂèØËßÜÂåñ„ÄÇÂåÖÂê´ÂºÄÂèë„ÄÅÂÜÖÂÆπÂàõ‰ΩúÂíåÊïàÁéáÂ∑•ÂÖ∑ÁöÑÂÆåÊï¥Áü•ËØÜÂõæË∞±„ÄÇ">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-bg: #000000;
            --secondary-bg: #0a0a1a;
            --glass-bg: rgba(10, 10, 36, 0.85);
            --primary-text: #e0e0ff;
            --border-color: rgba(147, 112, 219, 0.3);
            --font-main: 'Exo 2', 'Noto Sans SC', sans-serif;
            --glow-color: rgba(175, 143, 255, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: #000000;
            color: var(--primary-text);
            font-family: var(--font-main);
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-bg);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(147, 112, 219, 0.2);
            border-top: 3px solid var(--glow-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0% { filter: brightness(1) saturate(1); }
            100% { filter: brightness(1.2) saturate(1.3); }
        }

        .loading-text {
            font-size: 1.2rem;
            color: var(--primary-text);
            margin-bottom: 10px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(147, 112, 219, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--glow-color), #3b82f6);
            border-radius: 2px;
            transition: width 0.3s ease;
            animation: glow 2s ease-in-out infinite alternate;
        }

        /* --- 3D Canvas & UI --- */
        #ai-nebula-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            cursor: grab;
            touch-action: none;
        }
        #ai-nebula-container:active { cursor: grabbing; }
        #ai-nebula-container canvas {
            display: block;
            outline: none;
        }

        .ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: clamp(1rem, 4vw, 2rem);
        }

        .title-container { 
            text-align: center; 
            pointer-events: none;
        }
        .main-title { 
            font-size: clamp(2rem, 5vw, 3.5rem); 
            font-weight: 700; 
            color: #fff; 
            text-shadow: 
                0 0 15px var(--glow-color),
                0 0 25px rgba(175, 143, 255, 0.5),
                0 0 35px rgba(175, 143, 255, 0.3); 
            margin-bottom: 0.5rem;
            animation: float 6s ease-in-out infinite;
        }
        .subtitle { 
            font-size: clamp(0.9rem, 2vw, 1.1rem); 
            color: #d1d5db; 
            font-weight: 300;
            opacity: 0.9;
        }

        .instruction-text {
            position: absolute;
            bottom: 8%;
            color: rgba(255, 255, 255, 0.6);
            font-size: clamp(0.8rem, 2vw, 0.95rem);
            text-align: center;
            transition: opacity 1.5s ease-in-out;
            pointer-events: none;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }
        .instruction-text.fade-out { opacity: 0; }

        /* --- Constellation Navigation --- */
        .nav-buttons {
            pointer-events: all;
            display: flex;
            gap: 0.75rem;
            background: rgba(0,0,0,0.6);
            padding: 0.75rem 1.25rem;
            border-radius: 50px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            flex-wrap: wrap;
            justify-content: center;
        }
        .nav-button {
            background: transparent;
            border: 1px solid transparent;
            color: var(--primary-text);
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: var(--font-main);
            font-size: 0.9rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }
        .nav-button:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            color: #fff;
        }
        .nav-button.active {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.4);
            color: #fff;
            box-shadow: 
                0 4px 15px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
        }
        
        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: skewX(-30deg);
            transition: left 0.6s ease;
        }

        .nav-button:hover::before {
            left: 100%;
        }

        /* --- Tool Detail Panel --- */
        #tool-detail-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 550px;
            max-height: 80vh;
            background: rgba(10, 10, 36, 0.95);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(147, 112, 219, 0.4);
            border-radius: 20px;
            padding: 2rem;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 25px 50px rgba(0,0,0,0.5),
                0 0 50px rgba(147, 112, 219, 0.2),
                inset 0 1px 0 rgba(255,255,255,0.1);
            overflow-y: auto;
        }
        #tool-detail-panel.visible { 
            opacity: 1; 
            transform: translate(-50%, -50%) scale(1); 
            pointer-events: all; 
        }
        .close-panel-btn { 
            position: absolute; 
            top: 1rem; 
            right: 1rem; 
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--primary-text); 
            cursor: pointer; 
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        .close-panel-btn:hover {
            background: rgba(255,255,255,0.2);
            color: #fff;
            transform: rotate(90deg);
        }
        .detail-header { 
            display: flex; 
            align-items: center; 
            gap: 1rem; 
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .detail-icon { 
            font-size: 3rem;
            filter: drop-shadow(0 0 10px var(--glow-color));
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .detail-icon img {
            width: 100%;
            height: 100%;
            filter: brightness(0) invert(1);
        }
        .detail-info h3 { 
            font-size: 1.8rem; 
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #fff;
        }
        .detail-category { 
            display: inline-block;
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        .detail-description { 
            font-size: 1rem; 
            line-height: 1.6; 
            margin-bottom: 1.5rem;
            color: #d1d5db;
        }
        .detail-stats {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .proficiency-ring { 
            width: 60px; 
            height: 60px; 
            border-radius: 50%; 
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem; 
            font-weight: 700;
            color: #fff;
            position: relative;
            background: conic-gradient(from 0deg, #3b82f6, #9370db, #ec4899, #3b82f6);
            padding: 3px;
        }
        .proficiency-ring::before { 
            content: ''; 
            position: absolute; 
            inset: 3px; 
            background: var(--secondary-bg); 
            border-radius: 50%;
            z-index: 1;
        }
        .proficiency-ring span { 
            position: relative; 
            z-index: 2;
        }
        .proficiency-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .proficiency-label { 
            font-size: 0.9rem; 
            color: #9ca3af;
            font-weight: 500;
        }
        .proficiency-description {
            font-size: 0.85rem;
            color: #d1d5db;
            line-height: 1.4;
        }
        .detail-usage {
            margin-bottom: 1.5rem;
        }
        .detail-usage h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #fff;
        }
        .detail-usage p {
            font-size: 0.9rem;
            color: #d1d5db;
            line-height: 1.5;
        }
        .detail-features { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .feature-tag { 
            padding: 0.4rem 0.8rem; 
            background: rgba(147, 112, 219, 0.2);
            color: #ddd6fe;
            border-radius: 20px; 
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(147, 112, 219, 0.3);
            transition: all 0.3s ease;
        }
        .feature-tag:hover {
            background: rgba(147, 112, 219, 0.3);
            transform: translateY(-1px);
        }

        .multi-constellation-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, #9370db, #60a5fa);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(147, 112, 219, 0.5);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-buttons {
                flex-direction: column;
                gap: 0.5rem;
                padding: 1rem;
            }
            .nav-button {
                width: 100%;
                text-align: center;
            }
            #tool-detail-panel {
                width: 95%;
                padding: 1.5rem;
                max-height: 85vh;
            }
            .detail-header {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
            .detail-stats {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .ui-overlay {
                padding: 1rem;
            }
            #tool-detail-panel {
                padding: 1rem;
            }
            .detail-header .detail-icon {
                font-size: 2.5rem;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            .loading-spinner,
            .main-title,
            .nav-button::before,
            .loading-progress-bar {
                animation: none;
            }
            .nav-button:hover,
            .close-panel-btn:hover,
            .feature-tag:hover {
                transform: none;
            }
        }
    </style>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.164.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.164.1/examples/jsm/"
        }
    }
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Ê≠£Âú®ÂàùÂßãÂåñÊòü‰∫ë...</div>
        <div class="loading-progress">
            <div class="loading-progress-bar" id="loading-progress-bar" style="width: 0%"></div>
        </div>
    </div>

    <div id="ai-nebula-container"></div>

    <div class="ui-overlay">
        <div class="title-container">
            <h1 class="main-title">Êô®ÊòèÊïÖ‰∫∫ÁöÑAIÂ∑•ÂÖ∑Êòü‰∫ë</h1>
            <p class="subtitle">Êô®ÊòèÊïÖ‰∫∫ÁöÑAIÂ∑•ÂÖ∑‰∫§‰∫íÁü•ËØÜÂõæË∞± | Interactive AI Tools Knowledge Graph</p>
        </div>
        
        <div class="nav-buttons" id="nav-buttons-container"></div>

        <div class="instruction-text" id="instruction-text">ÊãñÊãΩÂèØÊóãËΩ¨ÔºåÁÇπÂáªÊòüËæ∞ÂèØÊé¢Á¥¢ | Drag to rotate, click stars to explore</div>
    </div>

    <div id="tool-detail-panel"></div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        // Tool logos mapping
        const toolLogos = {
            'claude-code': 'https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/claude-ai-icon.svg',
            'claude-web': 'https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/claude-ai-icon.svg',
            'cursor': 'https://raw.githubusercontent.com/getcursor/cursor/main/resources/app/resources/win32/cursor.ico',
            'bolt': 'https://www.stackblitz.com/favicon.ico',
            'deepseek-api': 'https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/deepseek-logo-icon.svg',
            'gemini': 'https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/google-gemini-icon.svg',
            'gamma': 'https://gamma.app/favicon.ico',
            'wispr-flow': 'https://wispr.com/favicon.ico',
            'n8n': 'https://n8n.io/favicon.ico',
            'notebookllm': 'https://notebooklm.google.com/favicon.ico',
            'v0': 'https://v0.dev/favicon.ico',
            'replit': 'https://replit.com/favicon.ico',
            'jimeng': 'https://jimeng.jianying.com/favicon.ico',
            'doubao': 'https://seed.bytedance.com/favicon.ico',
            'perplexity': 'https://www.perplexity.ai/favicon.ico',
            'lovable': 'https://lovable.dev/favicon.ico',
            'roo-code': 'https://marketplace.visualstudio.com/favicon.ico'
        };

        const aiTools = [ 
            // ÂºÄÂèëÂ∑•ÂÖ∑
            { id: 'claude-code', name: 'Claude Code', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: '‰∏ªÂäõAIÂ∑•ÂÖ∑ÔºåÁªàÁ´ØÂëΩ‰ª§Ë°åAIÂä©ÊâãÔºåÊ∑±Â∫¶ÈõÜÊàêÂºÄÂèëÂ∑•‰ΩúÊµÅÁ®ã„ÄÇÊèê‰æõÂÆûÊó∂‰ª£Á†ÅÂª∫ËÆÆ„ÄÅÁ≥ªÁªüËØäÊñ≠ÂíåÂ∑•‰ΩúÊµÅ‰ºòÂåñ„ÄÇ', usage: 'Êó•Â∏∏ÁºñÁ®ã„ÄÅÁ≥ªÁªüÁÆ°ÁêÜ„ÄÅÈóÆÈ¢òËß£ÂÜ≥', proficiency: 95, icon: 'ü§ñ', features: ['ÂëΩ‰ª§Ë°åÈõÜÊàê', '‰ª£Á†ÅÁîüÊàê', 'Á≥ªÁªüËØäÊñ≠', 'Â∑•‰ΩúÊµÅ‰ºòÂåñ', 'ÂÆûÊó∂Âª∫ËÆÆ'], categories: ['development', 'productivity'] }, 
            { id: 'cursor', name: 'Cursor', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'Èù©ÂëΩÊÄßÁöÑAIÁºñÁ®ãÁºñËæëÂô®ÔºåÂ∞ÜAIÊ∑±Â∫¶ÈõÜÊàêÂà∞ÂºÄÂèëÁéØÂ¢É‰∏≠ÔºåÊèê‰æõÊô∫ËÉΩ‰ª£Á†ÅË°•ÂÖ®ÂíåÈáçÊûÑÂª∫ËÆÆ„ÄÇ', usage: '‰ª£Á†ÅÁºñÂÜô„ÄÅÈáçÊûÑ„ÄÅË∞ÉËØï', proficiency: 88, icon: '‚å®Ô∏è', features: ['Êô∫ËÉΩË°•ÂÖ®', 'AIÈáçÊûÑ', '‰ª£Á†ÅËß£Èáä', 'Âø´ÈÄü‰øÆÂ§ç', '‰∏ä‰∏ãÊñáÊÑüÁü•'], categories: ['development'] }, 
            { id: 'bolt', name: 'Bolt', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'Âø´ÈÄüÂéüÂûãÂíåÂÖ®Ê†àÂºÄÂèëAIÂä©ÊâãÔºåËÉΩÂ§ü‰ªéÊÉ≥Ê≥ïÂø´ÈÄüÁîüÊàêÂèØËøêË°åÁöÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ', usage: 'Âø´ÈÄüÂéüÂûã„ÄÅÂÖ®Ê†àÂºÄÂèë„ÄÅÊÉ≥Ê≥ïÈ™åËØÅ', proficiency: 75, icon: '‚ö°', features: ['Âø´ÈÄüÂéüÂûã', 'ÂÖ®Ê†àÁîüÊàê', 'Âç≥Êó∂È¢ÑËßà', 'ÈÉ®ÁΩ≤ÈõÜÊàê', 'Ê®°ÊùøÂ∫ì'], categories: ['development', 'productivity'] }, 
            { id: 'deepseek-api', name: 'DeepSeek API', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'È´òÊÄßËÉΩÁöÑAI APIÊúçÂä°ÔºåÊèê‰æõÂº∫Â§ßÁöÑÊé®ÁêÜËÉΩÂäõÂíå‰ª£Á†ÅÁîüÊàêÂäüËÉΩÔºåÊàêÊú¨ÊïàÁõäÊûÅÈ´ò„ÄÇ', usage: 'APIÈõÜÊàê„ÄÅËá™Âä®Âåñ‰ªªÂä°„ÄÅÊâπÈáèÂ§ÑÁêÜ', proficiency: 82, icon: 'üîå', features: ['È´òÊÄßËÉΩAPI', '‰ª£Á†ÅÁîüÊàê', 'ÊâπÈáèÂ§ÑÁêÜ', 'ÊàêÊú¨ÊïàÁõä', 'ÊòìÈõÜÊàê'], categories: ['development'] }, 
            { id: 'v0', name: 'v0 by Vercel', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'AIÈ©±Âä®ÁöÑUIÁîüÊàêÂô®ÔºåÂ∞ÜËá™ÁÑ∂ËØ≠Ë®ÄÊèèËø∞ËΩ¨Êç¢‰∏∫ReactÁªÑ‰ª∂ÔºåÊîØÊåÅTailwind CSSÂíåshadcn/ui„ÄÇ', usage: 'UIÁªÑ‰ª∂ÁîüÊàê„ÄÅÂø´ÈÄüÂéüÂûã„ÄÅÂâçÁ´ØÂºÄÂèë', proficiency: 80, icon: 'üé®', features: ['ÊñáÊú¨Âà∞UI', 'ReactÁªÑ‰ª∂', 'Tailwind CSS', 'Âç≥Êó∂È¢ÑËßà', 'Â§öÊ®°ÊÄÅËæìÂÖ•'], categories: ['development', 'content'] },
            { id: 'replit', name: 'Replit Agent', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: '‰∫ëÁ´ØAIÂºÄÂèëÂπ≥Âè∞ÔºåÂ∞ÜËá™ÁÑ∂ËØ≠Ë®ÄËΩ¨Êç¢‰∏∫ÂÆåÊï¥Â∫îÁî®ÔºåÂåÖÂê´ÂâçÂêéÁ´Ø„ÄÅÊï∞ÊçÆÂ∫ìÂíåÈÉ®ÁΩ≤„ÄÇ', usage: 'ÂÖ®Ê†àÂºÄÂèë„ÄÅÂø´ÈÄüÂéüÂûã„ÄÅÂçè‰ΩúÁºñÁ®ã', proficiency: 85, icon: 'üöÄ', features: ['AI Agent', '‰∫ëÁ´ØIDE', '‰∏ÄÈîÆÈÉ®ÁΩ≤', 'ÂÆûÊó∂Âçè‰Ωú', 'Â§öËØ≠Ë®ÄÊîØÊåÅ'], categories: ['development', 'productivity'] },
            { id: 'lovable', name: 'Lovable', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'AIÂÖ®Ê†àÂ∫îÁî®ÊûÑÂª∫Âô®ÔºåÈÄöËøáËá™ÁÑ∂ËØ≠Ë®ÄÁîüÊàêÂÆåÊï¥WebÂ∫îÁî®ÔºåÊèê‰æõ‰ª£Á†ÅÊâÄÊúâÊùÉ„ÄÇ', usage: 'MVPÂºÄÂèë„ÄÅÂ∫îÁî®ÂéüÂûã„ÄÅÊó†‰ª£Á†ÅÂºÄÂèë', proficiency: 75, icon: 'üíù', features: ['Ëá™ÁÑ∂ËØ≠Ë®ÄÁºñÁ®ã', 'ÂÖ®Ê†àÁîüÊàê', 'GitHubÈõÜÊàê', 'ÂÆûÊó∂È¢ÑËßà', '‰ª£Á†ÅÂØºÂá∫'], categories: ['development', 'productivity'] },
            { id: 'roo-code', name: 'Roo Code', category: 'ÂºÄÂèëAIÂ∑•ÂÖ∑', description: 'VS Code‰∏≠ÁöÑAIÂºÄÂèëÂõ¢ÈòüÔºåÊèê‰æõÂ§öÁßç‰∏ìÈó®Ê®°ÂºèÁöÑËá™‰∏ªÁºñÁ®ãÂä©Êâã„ÄÇ', usage: 'VS CodeÂºÄÂèë„ÄÅ‰ª£Á†ÅÂÆ°Êü•„ÄÅÊû∂ÊûÑËÆæËÆ°', proficiency: 78, icon: 'ü¶ò', features: ['Â§öÊ®°ÂºèAI', 'Ëá™‰∏ªÂºÄÂèë', 'MCPÈõÜÊàê', 'ÊµèËßàÂô®Ëá™Âä®Âåñ', 'ÊàêÊú¨‰ºòÂåñ'], categories: ['development'] },
            
            // ÂÜÖÂÆπÂàõ‰ΩúÂ∑•ÂÖ∑
            { id: 'claude-web', name: 'Claude (ÁΩëÈ°µÁâà)', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'ÊúÄÊó©Êé•Ëß¶ÁöÑAIÂ∑•ÂÖ∑ÔºåÁî®‰∫éÂ≠¶‰π†„ÄÅÁ†îÁ©∂ÂíåÂÜÖÂÆπÂàõ‰Ωú„ÄÇÂº∫Â§ßÁöÑËá™ÁÑ∂ËØ≠Ë®ÄÂ§ÑÁêÜËÉΩÂäõÔºåÊîØÊåÅÂ§çÊùÇ‰ªªÂä°Êé®ÁêÜ„ÄÇ', usage: 'Á†îÁ©∂ÂàÜÊûê„ÄÅÂÜô‰ΩúËæÖÂä©„ÄÅÂ≠¶‰π†ËÆ®ËÆ∫', proficiency: 90, icon: 'üí¨', features: ['Ëá™ÁÑ∂ÂØπËØù', 'Á†îÁ©∂ÂàÜÊûê', 'Âàõ‰ΩúËæÖÂä©', 'Â§öËØ≠Ë®ÄÊîØÊåÅ', 'Êé®ÁêÜËÉΩÂäõ'], categories: ['content', 'productivity'] }, 
            { id: 'gemini', name: 'Gemini', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'GoogleÁöÑÂ§öÊ®°ÊÄÅAIÊ®°ÂûãÔºåÂú®ÂõæÂÉèÁêÜËß£„ÄÅËßÜÈ¢ëÂàÜÊûêÂíåÂ§çÊùÇÊé®ÁêÜÊñπÈù¢Ë°®Áé∞ÂçìË∂ä„ÄÇ', usage: 'Â§öÊ®°ÊÄÅÂàÜÊûê„ÄÅÂõæÂÉèÂ§ÑÁêÜ„ÄÅËßÜÈ¢ëÁêÜËß£', proficiency: 78, icon: 'üíé', features: ['Â§öÊ®°ÊÄÅÂ§ÑÁêÜ', 'ÂõæÂÉèÂàÜÊûê', 'ËßÜÈ¢ëÁêÜËß£', 'Â§çÊùÇÊé®ÁêÜ', 'Â§ß‰∏ä‰∏ãÊñá'], categories: ['content'] }, 
            { id: 'gamma', name: 'Gamma', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'AIÈ©±Âä®ÁöÑÊºîÁ§∫ÊñáÁ®øÂíåÊñáÊ°£ÂàõÂª∫Â∑•ÂÖ∑ÔºåËÉΩÂ§üÂø´ÈÄüÁîüÊàê‰∏ì‰∏öÁ∫ßÁöÑËßÜËßâÂÜÖÂÆπ„ÄÇ', usage: 'ÊºîÁ§∫ÊñáÁ®ø„ÄÅÊñáÊ°£ËÆæËÆ°„ÄÅËßÜËßâÂÜÖÂÆπ', proficiency: 70, icon: 'üìä', features: ['Ëá™Âä®ËÆæËÆ°', 'Ê®°ÊùøÁîüÊàê', 'ÂÜÖÂÆπ‰ºòÂåñ', 'Âçè‰ΩúÂäüËÉΩ', 'ÂØºÂá∫ÈÄâÈ°π'], categories: ['content', 'productivity'] }, 
            { id: 'wispr-flow', name: 'Wispr Flow', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'ÂÖàËøõÁöÑËØ≠Èü≥ËΩ¨ÊñáÂ≠óAIÂ∑•ÂÖ∑ÔºåÊîØÊåÅÂÆûÊó∂ËΩ¨ÂΩïÂíåÂ§öËØ≠Ë®ÄËØÜÂà´ÔºåÂáÜÁ°ÆÁéáÊûÅÈ´ò„ÄÇ', usage: 'ËØ≠Èü≥ËΩ¨ÂΩï„ÄÅ‰ºöËÆÆËÆ∞ÂΩï„ÄÅÂÜÖÂÆπÂàõ‰Ωú', proficiency: 85, icon: 'üéôÔ∏è', features: ['ÂÆûÊó∂ËΩ¨ÂΩï', 'Â§öËØ≠Ë®ÄÊîØÊåÅ', 'È´òÂáÜÁ°ÆÁéá', 'Ê†áÁÇπÊô∫ËÉΩ', 'Ê†ºÂºèÂåñËæìÂá∫'], categories: ['content', 'productivity'] },
            { id: 'jimeng', name: 'Âç≥Ê¢¶ AI', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'Â≠óËäÇË∑≥Âä®ÁöÑAIËßÜÈ¢ëÁîüÊàêÂπ≥Âè∞ÔºåÊîØÊåÅÊñáÊú¨ÂíåÂõæÂÉèÁîüÊàêÈ´òË¥®ÈáèÁü≠ËßÜÈ¢ë„ÄÇ', usage: 'ËßÜÈ¢ëÂàõ‰Ωú„ÄÅÁ§æ‰∫§Â™í‰Ωì„ÄÅËê•ÈîÄÂÜÖÂÆπ', proficiency: 72, icon: 'üé¨', features: ['ÊñáÊú¨ÁîüÊàêËßÜÈ¢ë', 'ÂõæÂÉèÁîüÊàêËßÜÈ¢ë', 'Êô∫ËÉΩÁîªÂ∏É', 'ÊïÖ‰∫ãÂàõ‰Ωú', '‰∏≠Êñá‰ºòÂåñ'], categories: ['content'] },
            { id: 'doubao', name: 'Ë±ÜÂåÖ AI', category: 'ÂÜÖÂÆπÂàõ‰Ωú', description: 'Â≠óËäÇË∑≥Âä®ÁöÑÊóóËà∞AIÂä©ÊâãÔºå‰∏≠ÂõΩÊúÄÂèóÊ¨¢ËøéÁöÑÊ∂àË¥πÁ∫ßAIÂ∫îÁî®ÔºåÊîØÊåÅÂ§öÊ®°ÊÄÅÂäüËÉΩ„ÄÇ', usage: 'ÂØπËØù‰∫§‰∫í„ÄÅÂõæÂÉèÁîüÊàê„ÄÅÂÜÖÂÆπÂàõ‰Ωú', proficiency: 76, icon: 'üå±', features: ['Â§öÊ®°ÊÄÅAI', 'ÂõæÂÉèÁîüÊàê', 'ËßÜÈ¢ëÁîüÊàê', '3DÁîüÊàê', 'ÊûÅ‰Ωé‰ª∑Ê†º'], categories: ['content', 'productivity'] },
            
            // ÊïàÁéáÂ∑•ÂÖ∑
            { id: 'n8n', name: 'n8n', category: 'ÊïàÁéáÂ∑•ÂÖ∑', description: 'ÂºÄÊ∫êÁöÑÂ∑•‰ΩúÊµÅËá™Âä®ÂåñÂπ≥Âè∞ÔºåÂèØ‰ª•ËøûÊé•ÂêÑÁßçÊúçÂä°ÂíåAIÂ∑•ÂÖ∑ÔºåÂàõÂª∫Â§çÊùÇÁöÑËá™Âä®ÂåñÊµÅÁ®ã„ÄÇ', usage: 'Â∑•‰ΩúÊµÅËá™Âä®Âåñ„ÄÅÊï∞ÊçÆÈõÜÊàê„ÄÅ‰ªªÂä°ÁºñÊéí', proficiency: 80, icon: 'üîÑ', features: ['ÂèØËßÜÂåñÁºñÊéí', '‰∏∞ÂØåÈõÜÊàê', 'Ëá™ÂÆö‰πâËäÇÁÇπ', 'ÂºÄÊ∫êÂÖçË¥π', '‰ºÅ‰∏öÁ∫ß'], categories: ['productivity'] }, 
            { id: 'notebookllm', name: 'NotebookLM', category: 'ÊïàÁéáÂ∑•ÂÖ∑', description: 'GoogleÁöÑAIÁ†îÁ©∂Âä©ÊâãÔºåËÉΩÂ§üÂü∫‰∫éÁî®Êà∑ÊñáÊ°£ÂàõÂª∫‰∏™ÊÄßÂåñÁöÑAIÁ†îÁ©∂‰ºô‰º¥„ÄÇ', usage: 'ÊñáÊ°£ÂàÜÊûê„ÄÅÁ†îÁ©∂ËæÖÂä©„ÄÅÁü•ËØÜÊèêÂèñ', proficiency: 72, icon: 'üìö', features: ['ÊñáÊ°£ÁêÜËß£', 'Áü•ËØÜÊèêÂèñ', '‰∏™ÊÄßÂåñAI', 'Á†îÁ©∂Âä©Êâã', 'ÂºïÁî®ËøΩË∏™'], categories: ['productivity', 'content'] },
            { id: 'perplexity', name: 'Perplexity', category: 'ÊïàÁéáÂ∑•ÂÖ∑', description: 'AIÈ©±Âä®ÁöÑÊêúÁ¥¢ÂºïÊìéÔºåÊèê‰æõÂÆûÊó∂ÂáÜÁ°ÆÁöÑÁ≠îÊ°àÔºåÂ∏¶ÊúâÂºïÁî®Êù•Ê∫ê„ÄÇ', usage: 'Á†îÁ©∂ÊêúÁ¥¢„ÄÅÂÆûÊó∂‰ø°ÊÅØ„ÄÅÁü•ËØÜËé∑Âèñ', proficiency: 83, icon: 'üîç', features: ['ÂÆûÊó∂ÊêúÁ¥¢', 'ÂºïÁî®Êù•Ê∫ê', 'Ê∑±Â∫¶Á†îÁ©∂', 'APIËÆøÈóÆ', 'Â§öÊ®°ÊÄÅÊêúÁ¥¢'], categories: ['productivity', 'content'] }
        ];

        const constellations = [
            { name: "ÂºÄÂèëÊòüÂ∫ß", nameEn: "Development", color: 0x60a5fa, tools: ['cursor', 'deepseek-api', 'v0', 'roo-code', 'claude-code', 'bolt', 'replit', 'lovable'], icon: 'üíª' },
            { name: "ÂÜÖÂÆπÊòüÂ∫ß", nameEn: "Content", color: 0xf472b6, tools: ['gemini', 'jimeng', 'v0', 'claude-web', 'gamma', 'wispr-flow', 'doubao', 'notebookllm', 'perplexity'], icon: 'üìù' },
            { name: "ÊïàÁéáÊòüÂ∫ß", nameEn: "Productivity", color: 0xfacc15, tools: ['n8n', 'claude-code', 'bolt', 'replit', 'lovable', 'claude-web', 'gamma', 'wispr-flow', 'doubao', 'notebookllm', 'perplexity'], icon: '‚ö°' }
        ];
        
        // Track which tools belong to multiple constellations
        const multiConstellationTools = new Set();
        const toolConstellations = {};
        constellations.forEach(constellation => {
            constellation.tools.forEach(tool => {
                if (!toolConstellations[tool]) {
                    toolConstellations[tool] = [];
                }
                toolConstellations[tool].push(constellation.name);
                if (toolConstellations[tool].length > 1) {
                    multiConstellationTools.add(tool);
                }
            });
        });

        function getProficiencyDescription(proficiency) {
            if (proficiency >= 90) return "‰∏ìÂÆ∂Á∫ß - Ê∑±Â∫¶ÈõÜÊàêÂ∑•‰ΩúÊµÅ | Expert Level";
            if (proficiency >= 80) return "ÁÜüÁªÉÁ∫ß - ÁªèÂ∏∏‰ΩøÁî® | Proficient";
            if (proficiency >= 70) return "‰∏≠Á∫ß - ÂÆöÊúü‰ΩøÁî® | Intermediate";
            return "ÂàùÁ∫ß - ÂÅ∂Â∞î‰ΩøÁî® | Beginner";
        }

        function updateLoadingProgress(progress, text) {
            const progressBar = document.getElementById('loading-progress-bar');
            const loadingText = document.querySelector('.loading-text');
            if (progressBar) progressBar.style.width = `${progress}%`;
            if (loadingText) loadingText.textContent = text;
        }

        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                loadingScreen.classList.add('hidden');
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 800);
            }
        }

        let scene, camera, renderer, controls, labelRenderer, particleSystem, clock;
        let starMeshes = [], constellationGroups = {}, allConstellationsContainer;
        const nebulaContainer = document.getElementById('ai-nebula-container');
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        let isFocused = false;
        let cameraTargetPos = new THREE.Vector3();
        let controlsTargetPos = new THREE.Vector3();
        let activeView = 'global';

        function init() {
            updateLoadingProgress(10, "ÂàùÂßãÂåñ3DÂú∫ÊôØ...");
            
            clock = new THREE.Clock();
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000); // Black background
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 5, 30);

            renderer = new THREE.WebGLRenderer({ 
                antialias: true, 
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.outputColorSpace = THREE.SRGBColorSpace;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            nebulaContainer.appendChild(renderer.domElement);

            labelRenderer = new CSS2DRenderer();
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.domElement.style.position = 'absolute';
            labelRenderer.domElement.style.top = '0px';
            labelRenderer.domElement.style.pointerEvents = 'none';
            labelRenderer.domElement.style.userSelect = 'none';
            nebulaContainer.appendChild(labelRenderer.domElement);

            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 8;
            controls.maxDistance = 60;
            controls.enablePan = false;
            controls.rotateSpeed = 0.5;
            controls.zoomSpeed = 0.8;

            updateLoadingProgress(30, "ÂàõÂª∫Á≤íÂ≠êÁ≥ªÁªü...");
            createParticles();
            
            updateLoadingProgress(50, "ÊûÑÂª∫ÊòüÂ∫ß...");
            createConstellations();
            
            updateLoadingProgress(70, "ËÆæÁΩÆ‰∫§‰∫íÊéßÂà∂...");
            setupNavigation();

            window.addEventListener('resize', onWindowResize);
            nebulaContainer.addEventListener('click', onStarClick);
            nebulaContainer.addEventListener('touchend', onStarClick);
            
            setTimeout(() => {
                document.getElementById('instruction-text').classList.add('fade-out');
            }, 5000);

            cameraTargetPos.set(0, 5, 30);
            controlsTargetPos.set(0, 0, 0);

            updateLoadingProgress(95, "ÂÆåÊàêÂä†ËΩΩ...");
            
            updateLoadingProgress(100, "ÂêØÂä®Êòü‰∫ë...");
            setTimeout(hideLoadingScreen, 500);
            
            animate();
        }

        function createParticles() {
            // Create black starry background with some glowing stars
            const particlesCount = Math.min(10000, window.innerWidth * 3);
            const positions = new Float32Array(particlesCount * 3);
            const colors = new Float32Array(particlesCount * 3);
            const sizes = new Float32Array(particlesCount);
            const glows = new Float32Array(particlesCount);

            for (let i = 0; i < particlesCount; i++) {
                const i3 = i * 3;
                
                // Spread stars across a larger sphere
                const radius = 50 + Math.random() * 150;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                
                positions[i3] = radius * Math.sin(phi) * Math.cos(theta);
                positions[i3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
                positions[i3 + 2] = radius * Math.cos(phi);
                
                // Most stars are white/blue-white, some have subtle color
                const isColoredStar = Math.random() < 0.15; // 15% colored stars
                const brightness = 0.3 + Math.random() * 0.7;
                
                if (isColoredStar) {
                    // Subtle star colors (blue, yellow, orange)
                    const starColors = [
                        [0.7, 0.8, 1.0],    // Blue-white
                        [1.0, 0.95, 0.8],   // Yellow-white
                        [1.0, 0.85, 0.7]    // Orange-white
                    ];
                    const colorChoice = starColors[Math.floor(Math.random() * starColors.length)];
                    colors[i3] = colorChoice[0] * brightness;
                    colors[i3 + 1] = colorChoice[1] * brightness;
                    colors[i3 + 2] = colorChoice[2] * brightness;
                } else {
                    // Pure white stars
                    colors[i3] = brightness;
                    colors[i3 + 1] = brightness;
                    colors[i3 + 2] = brightness;
                }
                
                // Vary star sizes, with some larger "bright" stars
                const isBrightStar = Math.random() < 0.05; // 5% bright stars
                sizes[i] = isBrightStar ? (1.5 + Math.random() * 2) : (0.3 + Math.random() * 0.8);
                glows[i] = isBrightStar ? 1 : 0;
            }
            
            const particlesGeometry = new THREE.BufferGeometry();
            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            particlesGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
            particlesGeometry.setAttribute('glow', new THREE.BufferAttribute(glows, 1));
            
            // Custom shader for star glow effect
            const starMaterial = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 }
                },
                vertexShader: `
                    attribute float size;
                    attribute float glow;
                    varying vec3 vColor;
                    varying float vGlow;
                    void main() {
                        vColor = color;
                        vGlow = glow;
                        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                        gl_PointSize = size * (300.0 / -mvPosition.z);
                        gl_Position = projectionMatrix * mvPosition;
                    }
                `,
                fragmentShader: `
                    uniform float time;
                    varying vec3 vColor;
                    varying float vGlow;
                    void main() {
                        vec2 center = gl_PointCoord - vec2(0.5);
                        float dist = length(center);
                        
                        // Create star shape with glow
                        float alpha = 1.0 - smoothstep(0.0, 0.5, dist);
                        
                        // Add extra glow for bright stars
                        if (vGlow > 0.5) {
                            float glowAlpha = 1.0 - smoothstep(0.0, 1.0, dist);
                            alpha = max(alpha, glowAlpha * 0.3);
                        }
                        
                        // Twinkle effect for bright stars
                        float twinkle = vGlow > 0.5 ? sin(time + gl_FragCoord.x * 0.1) * 0.2 + 0.8 : 1.0;
                        
                        gl_FragColor = vec4(vColor * twinkle, alpha);
                    }
                `,
                transparent: true,
                blending: THREE.AdditiveBlending,
                depthWrite: false
            });
            
            particleSystem = new THREE.Points(particlesGeometry, starMaterial);
            scene.add(particleSystem);
        }

        function createStar(tool, constellationColor) {
            const starGroup = new THREE.Group();
            starGroup.userData = { tool: tool, originalScale: 1 };

            // Larger invisible sphere for better click detection
            const clickGeometry = new THREE.SphereGeometry(1.2, 8, 8);
            const clickMaterial = new THREE.MeshBasicMaterial({
                transparent: true,
                opacity: 0,
                depthWrite: false
            });
            const clickMesh = new THREE.Mesh(clickGeometry, clickMaterial);
            starGroup.add(clickMesh);

            // Core star with enhanced visuals
            const coreGeometry = new THREE.SphereGeometry(0.4, 16, 12);
            const glowGeometry = new THREE.SphereGeometry(0.7, 16, 12);
            const outerGlowGeometry = new THREE.SphereGeometry(1.0, 12, 8);
            
            const coreMaterial = new THREE.MeshBasicMaterial({
                color: constellationColor,
                transparent: true,
                opacity: 1
            });
            
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: constellationColor,
                transparent: true,
                opacity: 0.4,
                blending: THREE.AdditiveBlending
            });

            const outerGlowMaterial = new THREE.MeshBasicMaterial({
                color: constellationColor,
                transparent: true,
                opacity: 0.2,
                blending: THREE.AdditiveBlending
            });

            const coreMesh = new THREE.Mesh(coreGeometry, coreMaterial);
            const glowMesh = new THREE.Mesh(glowGeometry, glowMaterial);
            const outerGlowMesh = new THREE.Mesh(outerGlowGeometry, outerGlowMaterial);
            
            starGroup.add(coreMesh);
            starGroup.add(glowMesh);
            starGroup.add(outerGlowMesh);

            const logoUrl = toolLogos[tool.id];
            const fallbackEmoji = tool.icon;
            const isMultiConstellation = multiConstellationTools.has(tool.id);

            const labelDiv = document.createElement('div');
            labelDiv.innerHTML = `
                <div style="
                    background: rgba(0, 0, 0, 0.85);
                    color: white;
                    padding: 6px 10px;
                    border-radius: 10px;
                    font-size: 13px;
                    font-weight: 500;
                    backdrop-filter: blur(15px);
                    border: 1px solid rgba(255, 255, 255, 0.25);
                    white-space: nowrap;
                    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
                    transform: translateY(-20px);
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    position: relative;
                ">
                    ${logoUrl ? `<img src="${logoUrl}" style="width: 16px; height: 16px; filter: brightness(0) invert(1);" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';" />` : ''}
                    <span style="${logoUrl ? 'display:none;' : ''}">${fallbackEmoji}</span>
                    ${tool.name}
                    ${isMultiConstellation ? '<span class="multi-constellation-badge">ËøûÊé•ËäÇÁÇπ</span>' : ''}
                </div>
            `;
            
            const label = new CSS2DObject(labelDiv);
            label.position.set(0, 1.2, 0);
            starGroup.add(label);

            return starGroup;
        }

        function createConnections(group, positions, color) {
            if (positions.length < 2) return;

            for (let i = 0; i < positions.length; i++) {
                const nextIndex = (i + 1) % positions.length;
                const start = positions[i];
                const end = positions[nextIndex];

                const points = [];
                const segments = 20;
                
                for (let j = 0; j <= segments; j++) {
                    const t = j / segments;
                    const point = new THREE.Vector3().lerpVectors(start, end, t);
                    const curvature = Math.sin(t * Math.PI) * 0.5;
                    point.y += curvature;
                    points.push(point);
                }

                const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: color,
                    transparent: true,
                    opacity: 0.4,
                    linewidth: 2
                });

                const line = new THREE.Line(lineGeometry, lineMaterial);
                group.add(line);
            }
        }

        function createConstellations() {
            const toolMap = new Map(aiTools.map(tool => [tool.id, tool]));
            allConstellationsContainer = new THREE.Group();
            const toolStars = {}; // Track created stars to avoid duplicates

            // Position constellations in a triangle formation
            const constellationPositions = [
                new THREE.Vector3(0, 5, -15),    // Development - top
                new THREE.Vector3(-15, -5, 10),  // Content - bottom left
                new THREE.Vector3(15, -5, 10)    // Productivity - bottom right
            ];

            constellations.forEach((constellation, cIndex) => {
                const constellationGroup = new THREE.Group();
                constellationGroup.userData = { 
                    constellation: constellation,
                    isVisible: true
                };
                const starPositions = [];
                const basePosition = constellationPositions[cIndex];

                constellation.tools.forEach((toolId, tIndex) => {
                    const tool = toolMap.get(toolId);
                    if (tool) {
                        let star;
                        
                        // Check if this tool belongs to multiple constellations
                        if (multiConstellationTools.has(toolId)) {
                            if (toolStars[toolId]) {
                                // Tool already created, position it between constellations
                                star = toolStars[toolId];
                                const otherConstellations = toolConstellations[toolId].filter(c => c !== constellation.name);
                                if (otherConstellations.length > 0) {
                                    // Position between current constellation and others
                                    const positions = [basePosition];
                                    otherConstellations.forEach(otherName => {
                                        const otherIndex = constellations.findIndex(c => c.name === otherName);
                                        if (otherIndex >= 0) {
                                            positions.push(constellationPositions[otherIndex]);
                                        }
                                    });
                                    
                                    // Calculate center position between constellations
                                    const centerPos = new THREE.Vector3();
                                    positions.forEach(pos => centerPos.add(pos));
                                    centerPos.divideScalar(positions.length);
                                    
                                    // Add some offset for visual appeal
                                    star.position.copy(centerPos);
                                    star.position.x += (Math.random() - 0.5) * 3;
                                    star.position.y += (Math.random() - 0.5) * 2;
                                    star.position.z += (Math.random() - 0.5) * 3;
                                }
                            } else {
                                // First time creating this multi-constellation tool
                                // Use a special color for multi-constellation tools (purple-white)
                                const multiColor = 0x9370db; // Medium purple
                                star = createStar(tool, multiColor);
                                toolStars[toolId] = star;
                                starMeshes.push(star);
                                
                                // Make multi-constellation stars slightly larger and brighter
                                star.scale.setScalar(1.3);
                                star.userData.originalScale = 1.3;
                            }
                        } else {
                            // Single constellation tool
                            star = createStar(tool, constellation.color);
                            starMeshes.push(star);
                            
                            // Position within constellation
                            const angle = (tIndex / constellation.tools.length) * Math.PI * 2;
                            const radius = 4 + Math.random() * 2;
                            const height = (Math.random() - 0.5) * 2;
                            
                            star.position.set(
                                basePosition.x + Math.cos(angle) * radius,
                                basePosition.y + height,
                                basePosition.z + Math.sin(angle) * radius
                            );
                        }
                        
                        if (!star.parent) {
                            constellationGroup.add(star);
                        }
                        starPositions.push(star.position.clone());
                    }
                });

                createConnections(constellationGroup, starPositions, constellation.color);
                
                // Add constellation glow effect with adjusted size
                const glowGeometry = new THREE.SphereGeometry(10, 32, 16);
                const glowMaterial = new THREE.ShaderMaterial({
                    uniforms: {
                        color: { value: new THREE.Color(constellation.color) },
                        viewVector: { value: camera.position }
                    },
                    vertexShader: `
                        uniform vec3 viewVector;
                        varying float intensity;
                        void main() {
                            vec3 vNormal = normalize( normalMatrix * normal );
                            vec3 vNormel = normalize( normalMatrix * viewVector );
                            intensity = pow( dot(vNormal, vNormel), 3.0 );
                            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
                        }
                    `,
                    fragmentShader: `
                        uniform vec3 color;
                        varying float intensity;
                        void main() {
                            vec3 glow = color * intensity;
                            gl_FragColor = vec4( glow, intensity * 0.08 );
                        }
                    `,
                    side: THREE.BackSide,
                    blending: THREE.AdditiveBlending,
                    transparent: true
                });
                
                const glowMesh = new THREE.Mesh(glowGeometry, glowMaterial);
                glowMesh.position.copy(basePosition);
                constellationGroup.add(glowMesh);

                constellationGroups[constellation.name] = constellationGroup;
                allConstellationsContainer.add(constellationGroup);
            });

            scene.add(allConstellationsContainer);
        }

        function setupNavigation() {
            const navContainer = document.getElementById('nav-buttons-container');
            
            // Global view button
            const globalBtn = document.createElement('button');
            globalBtn.className = 'nav-button active';
            globalBtn.textContent = 'üåå ÂÖ®Â±ÄËßÜÂõæ | Global';
            globalBtn.onclick = () => focusGlobal();
            navContainer.appendChild(globalBtn);

            // Constellation buttons
            constellations.forEach(constellation => {
                const btn = document.createElement('button');
                btn.className = 'nav-button';
                btn.textContent = `${constellation.icon} ${constellation.name}`;
                btn.onclick = () => focusConstellation(constellation.name);
                navContainer.appendChild(btn);
            });
        }

        function focusGlobal() {
            activeView = 'global';
            updateNavButtons();
            
            Object.values(constellationGroups).forEach(group => {
                group.visible = true;
                group.userData.isVisible = true;
            });

            animateCamera(
                new THREE.Vector3(0, 5, 30), 
                new THREE.Vector3(0, 0, 0)
            );
        }

        function focusConstellation(constellationName) {
            activeView = constellationName;
            updateNavButtons();
            
            const targetGroup = constellationGroups[constellationName];
            if (!targetGroup) return;

            Object.entries(constellationGroups).forEach(([name, group]) => {
                group.visible = (name === constellationName);
                group.userData.isVisible = (name === constellationName);
            });
            
            const box = new THREE.Box3().setFromObject(targetGroup);
            const center = box.getCenter(new THREE.Vector3());
            const size = box.getSize(new THREE.Vector3());
            
            const maxDim = Math.max(size.x, size.y, size.z);
            const fov = camera.fov * (Math.PI / 180);
            const cameraDistance = Math.abs(maxDim / Math.sin(fov / 2)) * 1.5;
            
            const cameraPosition = center.clone();
            cameraPosition.z += cameraDistance;
            cameraPosition.y += 2;
            
            animateCamera(cameraPosition, center);
        }

        function animateCamera(targetPosition, targetLookAt, duration = 2000) {
            const startPosition = camera.position.clone();
            const startLookAt = controls.target.clone();
            const startTime = Date.now();
            
            const updateCamera = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const easeInOutCubic = (t) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;
                const easedProgress = easeInOutCubic(progress);
                
                camera.position.lerpVectors(startPosition, targetPosition, easedProgress);
                controls.target.lerpVectors(startLookAt, targetLookAt, easedProgress);
                controls.update();
                
                if (progress < 1) {
                    requestAnimationFrame(updateCamera);
                }
            };
            
            updateCamera();
        }

        function updateNavButtons() {
            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach((btn, index) => {
                if (index === 0 && activeView === 'global') {
                    btn.classList.add('active');
                } else if (btn.textContent.includes(activeView)) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        }

        function onStarClick(event) {
            event.preventDefault();
            
            const rect = renderer.domElement.getBoundingClientRect();
            const clientX = 'clientX' in event ? event.clientX : 
                (event.touches && event.touches[0] ? event.touches[0].clientX : 
                 event.changedTouches[0].clientX);
            const clientY = 'clientY' in event ? event.clientY : 
                (event.touches && event.touches[0] ? event.touches[0].clientY : 
                 event.changedTouches[0].clientY);
            
            mouse.x = ((clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((clientY - rect.top) / rect.height) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(starMeshes, true);

            if (intersects.length > 0) {
                const starGroup = intersects[0].object.parent;
                if (starGroup && starGroup.userData && starGroup.userData.tool) {
                    showToolDetail(starGroup.userData.tool);
                    
                    if (navigator.vibrate) {
                        navigator.vibrate(50);
                    }
                }
            }
        }

        function showToolDetail(tool) {
            const panel = document.getElementById('tool-detail-panel');
            const logoUrl = toolLogos[tool.id];
            const isMultiConstellation = multiConstellationTools.has(tool.id);
            const belongsToConstellations = toolConstellations[tool.id] || [];
            
            panel.innerHTML = `
                <button class="close-panel-btn" onclick="hideToolDetail()">√ó</button>
                
                <div class="detail-header">
                    <div class="detail-icon">
                        ${logoUrl ? `<img src="${logoUrl}" onerror="this.style.display='none'; this.parentElement.innerHTML='${tool.icon}';" />` : tool.icon}
                    </div>
                    <div class="detail-info">
                        <h3>${tool.name}</h3>
                        <span class="detail-category">${tool.category}</span>
                        ${isMultiConstellation ? `<div style="margin-top: 0.5rem; font-size: 0.85rem; color: #9370db;">ËøûÊé•ËäÇÁÇπÔºö${belongsToConstellations.join(', ')}</div>` : ''}
                    </div>
                </div>
                
                <p class="detail-description">${tool.description}</p>
                
                <div class="detail-stats">
                    <div class="proficiency-ring">
                        <span>${tool.proficiency}%</span>
                    </div>
                    <div class="proficiency-info">
                        <div class="proficiency-label">ÁÜüÁªÉÂ∫¶ | Proficiency</div>
                        <div class="proficiency-description">
                            ${getProficiencyDescription(tool.proficiency)}
                        </div>
                    </div>
                </div>
                
                <div class="detail-usage">
                    <h4>‰ΩøÁî®Âú∫ÊôØ | Use Cases</h4>
                    <p>${tool.usage}</p>
                </div>
                
                <div class="detail-features">
                    ${tool.features.map(feature => `
                        <span class="feature-tag">${feature}</span>
                    `).join('')}
                </div>
            `;
            
            panel.classList.add('visible');
        }

        window.hideToolDetail = function() {
            const panel = document.getElementById('tool-detail-panel');
            panel.classList.remove('visible');
        }

        function animate() {
            requestAnimationFrame(animate);
            
            const deltaTime = clock.getDelta();
            const elapsedTime = clock.getElapsedTime();
            
            if (particleSystem) {
                particleSystem.rotation.y += deltaTime * 0.02;
                particleSystem.rotation.x += deltaTime * 0.01;
                
                // Update time uniform for twinkling stars
                if (particleSystem.material.uniforms) {
                    particleSystem.material.uniforms.time.value = elapsedTime;
                }
            }
            
            Object.values(constellationGroups).forEach((group, index) => {
                if (group.userData.isVisible) {
                    group.rotation.y += deltaTime * (0.1 + index * 0.02);
                    
                    // Update glow shader
                    const glowMesh = group.children.find(child => 
                        child instanceof THREE.Mesh && child.material instanceof THREE.ShaderMaterial
                    );
                    if (glowMesh && glowMesh.material.uniforms) {
                        glowMesh.material.uniforms.viewVector.value = camera.position;
                    }
                }
            });
            
            starMeshes.forEach((star, index) => {
                const breathe = 1 + Math.sin(elapsedTime * 2 + index * 0.5) * 0.1;
                star.scale.setScalar(breathe * (star.userData.originalScale || 1));
                
                // Animate outer glow opacity
                const outerGlow = star.children.find(child => 
                    child instanceof THREE.Mesh && child.geometry instanceof THREE.SphereGeometry && 
                    child.geometry.parameters.radius === 1.0
                );
                if (outerGlow && outerGlow.material) {
                    outerGlow.material.opacity = 0.2 + Math.sin(elapsedTime * 3 + index) * 0.1;
                }
            });
            
            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }

        // Initialize on load
        window.addEventListener('load', init);

        // Handle ESC key for closing panel
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                hideToolDetail();
            }
        });
    </script>
</body>
</html>